{"id": 24, "timestamp": "2026-01-06T14:15:28.151817", "source": "agent", "message": "I read the file /workspace/scikit-learn__scikit-learn__1.3/sklearn/_config.py.", "cause": 23, "observation": "read", "tool_call_metadata": {"function_name": "str_replace_editor", "tool_call_id": "toolu_09", "model_response": {"id": "chatcmpl-76ed1707181e4301a32287dff6bd06ab", "created": 1767708926, "model": "/mnt/shared/models/GLM-4.6-FP8", "object": "chat.completion", "system_fingerprint": null, "choices": [{"finish_reason": "stop", "index": 0, "message": {"content": "<think></think>\nNow let me check the config module to understand how `set_config(transform_output=\"pandas\")` works:", "role": "assistant", "tool_calls": [{"index": 1, "function": {"arguments": "{\"command\": \"view\", \"path\": \"/workspace/scikit-learn__scikit-learn__1.3/sklearn/_config.py\", \"security_risk\": \"LOW\"}", "name": "str_replace_editor"}, "id": "toolu_09", "type": "function"}], "function_call": null, "provider_specific_fields": null}}], "usage": {"completion_tokens": 81, "prompt_tokens": 0, "total_tokens": 81, "completion_tokens_details": {"accepted_prediction_tokens": null, "audio_tokens": null, "reasoning_tokens": 0, "rejected_prediction_tokens": null, "text_tokens": null, "image_tokens": null}, "prompt_tokens_details": null}}, "total_calls_in_response": 1}, "content": "Here's the result of running `cat -n` on /workspace/scikit-learn__scikit-learn__1.3/sklearn/_config.py:\n     1\t\"\"\"Global configuration state and functions for management\n     2\t\"\"\"\n     3\timport os\n     4\tfrom contextlib import contextmanager as contextmanager\n     5\timport threading\n     6\t\n     7\t_global_config = {\n     8\t    \"assume_finite\": bool(os.environ.get(\"SKLEARN_ASSUME_FINITE\", False)),\n     9\t    \"working_memory\": int(os.environ.get(\"SKLEARN_WORKING_MEMORY\", 1024)),\n    10\t    \"print_changed_only\": True,\n    11\t    \"display\": \"diagram\",\n    12\t    \"pairwise_dist_chunk_size\": int(\n    13\t        os.environ.get(\"SKLEARN_PAIRWISE_DIST_CHUNK_SIZE\", 256)\n    14\t    ),\n    15\t    \"enable_cython_pairwise_dist\": True,\n    16\t    \"array_api_dispatch\": False,\n    17\t    \"transform_output\": \"default\",\n    18\t}\n    19\t_threadlocal = threading.local()\n    20\t\n    21\t\n    22\tdef _get_threadlocal_config():\n    23\t    \"\"\"Get a threadlocal **mutable** configuration. If the configuration\n    24\t    does not exist, copy the default global configuration.\"\"\"\n    25\t    if not hasattr(_threadlocal, \"global_config\"):\n    26\t        _threadlocal.global_config = _global_config.copy()\n    27\t    return _threadlocal.global_config\n    28\t\n    29\t\n    30\tdef get_config():\n    31\t    \"\"\"Retrieve current values for configuration set by :func:`set_config`.\n    32\t\n    33\t    Returns\n    34\t    -------\n    35\t    config : dict\n    36\t        Keys are parameter names that can be passed to :func:`set_config`.\n    37\t\n    38\t    See Also\n    39\t    --------\n    40\t    config_context : Context manager for global scikit-learn configuration.\n    41\t    set_config : Set global scikit-learn configuration.\n    42\t    \"\"\"\n    43\t    # Return a copy of the threadlocal configuration so that users will\n    44\t    # not be able to modify the configuration with the returned dict.\n    45\t    return _get_threadlocal_config().copy()\n    46\t\n    47\t\n    48\tdef set_config(\n    49\t    assume_finite=None,\n    50\t    working_memory=None,\n    51\t    print_changed_only=None,\n    52\t    display=None,\n    53\t    pairwise_dist_chunk_size=None,\n    54\t    enable_cython_pairwise_dist=None,\n    55\t    array_api_dispatch=None,\n    56\t    transform_output=None,\n    57\t):\n    58\t    \"\"\"Set global scikit-learn configuration\n    59\t\n    60\t    .. versionadded:: 0.19\n    61\t\n    62\t    Parameters\n    63\t    ----------\n    64\t    assume_finite : bool, default=None\n    65\t        If True, validation for finiteness will be skipped,\n    66\t        saving time, but leading to potential crashes. If\n    67\t        False, validation for finiteness will be performed,\n    68\t        avoiding error.  Global default: False.\n    69\t\n    70\t        .. versionadded:: 0.19\n    71\t\n    72\t    working_memory : int, default=None\n    73\t        If set, scikit-learn will attempt to limit the size of temporary arrays\n    74\t        to this number of MiB (per job when parallelised), often saving both\n    75\t        computation time and memory on expensive operations that can be\n    76\t        performed in chunks. Global default: 1024.\n    77\t\n    78\t        .. versionadded:: 0.20\n    79\t\n    80\t    print_changed_only : bool, default=None\n    81\t        If True, only the parameters that were set to non-default\n    82\t        values will be printed when printing an estimator. For example,\n    83\t        ``print(SVC())`` while True will only print 'SVC()' while the default\n    84\t        behaviour would be to print 'SVC(C=1.0, cache_size=200, ...)' with\n    85\t        all the non-changed parameters.\n    86\t\n    87\t        .. versionadded:: 0.21\n    88\t\n    89\t    display : {'text', 'diagram'}, default=None\n    90\t        If 'diagram', estimators will be displayed as a diagram in a Jupyter\n    91\t        lab or notebook context. If 'text', estimators will be displayed as\n    92\t        text. Default is 'diagram'.\n    93\t\n    94\t        .. versionadded:: 0.23\n    95\t\n    96\t    pairwise_dist_chunk_size : int, default=None\n    97\t        The number of row vectors per chunk for the accelerated pairwise-\n    98\t        distances reduction backend. Default is 256 (suitable for most of\n    99\t        modern laptops' caches and architectures).\n   100\t\n   101\t        Intended for easier benchmarking and testing of scikit-learn internals.\n   102\t        End users are not expected to benefit from customizing this configuration\n   103\t        setting.\n   104\t\n   105\t        .. versionadded:: 1.1\n   106\t\n   107\t    enable_cython_pairwise_dist : bool, default=None\n   108\t        Use the accelerated pairwise-distances reduction backend when\n   109\t        possible. Global default: True.\n   110\t\n   111\t        Intended for easier benchmarking and testing of scikit-learn internals.\n   112\t        End users are not expected to benefit from customizing this configuration\n   113\t        setting.\n   114\t\n   115\t        .. versionadded:: 1.1\n   116\t\n   117\t    array_api_dispatch : bool, default=None\n   118\t        Use Array API dispatching when inputs follow the Array API standard.\n   119\t        Default is False.\n   120\t\n   121\t        See the :ref:`User Guide <array_api>` for more details.\n   122\t\n   123\t        .. versionadded:: 1.2\n   124\t\n   125\t    transform_output : str, default=None\n   126\t        Configure output of `transform` and `fit_transform`.\n   127\t\n   128\t        See :ref:`sphx_glr_auto_examples_miscellaneous_plot_set_output.py`\n   129\t        for an example on how to use the API.\n   130\t\n   131\t        - `\"default\"`: Default output format of a transformer\n   132\t        - `\"pandas\"`: DataFrame output\n   133\t        - `None`: Transform configuration is unchanged\n   134\t\n   135\t        .. versionadded:: 1.2\n   136\t\n   137\t    See Also\n   138\t    --------\n   139\t    config_context : Context manager for global scikit-learn configuration.\n   140\t    get_config : Retrieve current values of the global configuration.\n   141\t    \"\"\"\n   142\t    local_config = _get_threadlocal_config()\n   143\t\n   144\t    if assume_finite is not None:\n   145\t        local_config[\"assume_finite\"] = assume_finite\n   146\t    if working_memory is not None:\n   147\t        local_config[\"working_memory\"] = working_memory\n   148\t    if print_changed_only is not None:\n   149\t        local_config[\"print_changed_only\"] = print_changed_only\n   150\t    if display is not None:\n   151\t        local_config[\"display\"] = display\n   152\t    if pairwise_dist_chunk_size is not None:\n   153\t        local_config[\"pairwise_dist_chunk_size\"] = pairwise_dist_chunk_size\n   154\t    if enable_cython_pairwise_dist is not None:\n   155\t        local_config[\"enable_cython_pairwise_dist\"] = enable_cython_pairwise_dist\n   156\t    if array_api_dispatch is not None:\n   157\t        local_config[\"array_api_dispatch\"] = array_api_dispatch\n   158\t    if transform_output is not None:\n   159\t        local_config[\"transform_output\"] = transform_output\n   160\t\n   161\t\n   162\t@contextmanager\n   163\tdef config_context(\n   164\t    *,\n   165\t    assume_finite=None,\n   166\t    working_memory=None,\n   167\t    print_changed_only=None,\n   168\t    display=None,\n   169\t    pairwise_dist_chunk_size=None,\n   170\t    enable_cython_pairwise_dist=None,\n   171\t    array_api_dispatch=None,\n   172\t    transform_output=None,\n   173\t):\n   174\t    \"\"\"Context manager for global scikit-learn configuration.\n   175\t\n   176\t    Parameters\n   177\t    ----------\n   178\t    assume_finite : bool, default=None\n   179\t        If True, validation for finiteness will be skipped,\n   180\t        saving time, but leading to potential crashes. If\n   181\t        False, validation for finiteness will be performed,\n   182\t        avoiding error. If None, the existing value won't change.\n   183\t        The default value is False.\n   184\t\n   185\t    working_memory : int, default=None\n   186\t        If set, scikit-learn will attempt to limit the size of temporary arrays\n   187\t        to this number of MiB (per job when parallelised), often saving both\n   188\t        computation time and memory on expensive operations that can be\n   189\t        performed in chunks. If None, the existing value won't change.\n   190\t        The default value is 1024.\n   191\t\n   192\t    print_changed_only : bool, default=None\n   193\t        If True, only the parameters that were set to non-default\n   194\t        values will be printed when printing an estimator. For example,\n   195\t        ``print(SVC())`` while True will only print 'SVC()', but would print\n   196\t        'SVC(C=1.0, cache_size=200, ...)' with all the non-changed parameters\n   197\t        when False. If None, the existing value won't change.\n   198\t        The default value is True.\n   199\t\n   200\t        .. versionchanged:: 0.23\n   201\t           Default changed from False to True.\n   202\t\n   203\t    display : {'text', 'diagram'}, default=None\n   204\t        If 'diagram', estimators will be displayed as a diagram in a Jupyter\n   205\t        lab or notebook context. If 'text', estimators will be displayed as\n   206\t        text. If None, the existing value won't change.\n   207\t        The default value is 'diagram'.\n   208\t\n   209\t        .. versionadded:: 0.23\n   210\t\n   211\t    pairwise_dist_chunk_size : int, default=None\n   212\t        The number of row vectors per chunk for the accelerated pairwise-\n   213\t        distances reduction backend. Default is 256 (suitable for most of\n   214\t        modern laptops' caches and architectures).\n   215\t\n   216\t        Intended for easier benchmarking and testing of scikit-learn internals.\n   217\t        End users are not expected to benefit from customizing this configuration\n   218\t        setting.\n   219\t\n   220\t        .. versionadded:: 1.1\n   221\t\n   222\t    enable_cython_pairwise_dist : bool, default=None\n   223\t        Use the accelerated pairwise-distances reduction backend when\n   224\t        possible. Global default: True.\n   225\t\n   226\t        Intended for easier benchmarking and testing of scikit-learn internals.\n   227\t        End users are not expected to benefit from customizing this configuration\n   228\t        setting.\n   229\t\n   230\t        .. versionadded:: 1.1\n   231\t\n   232\t    array_api_dispatch : bool, default=None\n   233\t        Use Array API dispatching when inputs follow the Array API standard.\n   234\t        Default is False.\n   235\t\n   236\t        See the :ref:`User Guide <array_api>` for more details.\n   237\t\n   238\t        .. versionadded:: 1.2\n   239\t\n   240\t    transform_output : str, default=None\n   241\t        Configure output of `transform` and `fit_transform`.\n   242\t\n   243\t        See :ref:`sphx_glr_auto_examples_miscellaneous_plot_set_output.py`\n   244\t        for an example on how to use the API.\n   245\t\n   246\t        - `\"default\"`: Default output format of a transformer\n   247\t        - `\"pandas\"`: DataFrame output\n   248\t        - `None`: Transform configuration is unchanged\n   249\t\n   250\t        .. versionadded:: 1.2\n   251\t\n   252\t    Yields\n   253\t    ------\n   254\t    None.\n   255\t\n   256\t    See Also\n   257\t    --------\n   258\t    set_config : Set global scikit-learn configuration.\n   259\t    get_config : Retrieve current values of the global configuration.\n   260\t\n   261\t    Notes\n   262\t    -----\n   263\t    All settings, not just those presently modified, will be returned to\n   264\t    their previous values when the context manager is exited.\n   265\t\n   266\t    Examples\n   267\t    --------\n   268\t    >>> import sklearn\n   269\t    >>> from sklearn.utils.validation import assert_all_finite\n   270\t    >>> with sklearn.config_context(assume_finite=True):\n   271\t    ...     assert_all_finite([float('nan')])\n   272\t    >>> with sklearn.config_context(assume_finite=True):\n   273\t    ...     with sklearn.config_context(assume_finite=False):\n   274\t    ...         assert_all_finite([float('nan')])\n   275\t    Traceback (most recent call last):\n   276\t    ...\n   277\t    ValueError: Input contains NaN...\n   278\t    \"\"\"\n   279\t    old_config = get_config()\n   280\t    set_config(\n   281\t        assume_finite=assume_finite,\n   282\t        working_memory=working_memory,\n   283\t        print_changed_only=print_changed_only,\n   284\t        display=display,\n   285\t        pairwise_dist_chunk_size=pairwise_dist_chunk_size,\n   286\t        enable_cython_pairwise_dist=enable_cython_pairwise_dist,\n   287\t        array_api_dispatch=array_api_dispatch,\n   288\t        transform_output=transform_output,\n   289\t    )\n   290\t\n   291\t    try:\n   292\t        yield\n   293\t    finally:\n   294\t        set_config(**old_config)\n   295\t\n", "extras": {"path": "/workspace/scikit-learn__scikit-learn__1.3/sklearn/_config.py", "impl_source": "oh_aci"}}