2026-01-06 15:13:33,625 - INFO - [LLM registry 79a46f05-fd5e-4ae9-bc65-365ca1eda963]: Registering service for agent
2026-01-06 15:13:33,665 - INFO - Building image: ghcr.io/openhands/runtime:oh_v1.0.0_n19n8m9b8qx363gk_v008aov5t6vw3gr5
2026-01-06 15:20:06,076 - INFO - Image [ghcr.io/openhands/runtime:oh_v1.0.0_n19n8m9b8qx363gk_v008aov5t6vw3gr5] build finished.
2026-01-06 15:20:06,086 - INFO - Re-tagged image [ghcr.io/openhands/runtime:oh_v1.0.0_n19n8m9b8qx363gk_v008aov5t6vw3gr5] with more generic tag [oh_v1.0.0_n19n8m9b8qx363gk]
2026-01-06 15:20:06,087 - INFO - Image ghcr.io/openhands/runtime with tags [oh_v1.0.0_n19n8m9b8qx363gk_v008aov5t6vw3gr5, oh_v1.0.0_n19n8m9b8qx363gk] built successfully
2026-01-06 15:20:06,116 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Starting runtime with image: ghcr.io/openhands/runtime:oh_v1.0.0_n19n8m9b8qx363gk_v008aov5t6vw3gr5
2026-01-06 15:20:06,287 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Starting server with command: ['/openhands/micromamba/bin/micromamba', 'run', '-n', 'openhands', 'poetry', 'run', 'python', '-u', '-m', 'openhands.runtime.action_execution_server', '37364', '--working-dir', '/workspace', '--plugins', 'agent_skills', 'jupyter', '--username', 'root', '--user-id', '0', '--no-enable-browser']
2026-01-06 15:20:06,641 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Container started: openhands-runtime-37f30b81-57bd-41-945d3077b3dc679. VSCode URL: None
2026-01-06 15:20:06,641 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Waiting for client to become ready at http://localhost:37364...
2026-01-06 15:20:28,702 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Runtime is ready.
2026-01-06 15:20:31,814 - INFO - Successfully configured git: name=openhands, email=openhands@all-hands.dev
2026-01-06 15:20:31,896 - INFO - ------------------------------
2026-01-06 15:20:31,910 - INFO - BEGIN Runtime Initialization Fn
2026-01-06 15:20:31,910 - INFO - ------------------------------
2026-01-06 15:20:31,910 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
echo 'export SWE_INSTANCE_ID=django__django-15996' >> ~/.bashrc && echo 'export PIP_CACHE_DIR=~/.cache/pip' >> ~/.bashrc && echo "alias git='git --no-pager'" >> ~/.bashrc && git config --global core.pager "" && git config --global diff.binary false
2026-01-06 15:20:32,546 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:32,548 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
export USER=$(whoami); echo USER=${USER} 
2026-01-06 15:20:33,168 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
USER=root
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:33,168 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
mkdir -p /swe_util/eval_data/instances
2026-01-06 15:20:33,785 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:33,791 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
cat ~/.bashrc
2026-01-06 15:20:34,410 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
source /opt/miniconda3/etc/profile.d/conda.sh && conda activate testbed

. "/openhands/bin/env"
export PATH="/usr/bin:/bin:/usr/sbin:/sbin:/openhands/micromamba/bin:$PATH"
export PLAYWRIGHT_BROWSERS_PATH=/opt/playwright-browsers
eval "$(/openhands/micromamba/bin/micromamba shell hook --shell bash)"
micromamba activate openhands 2>/dev/null || true
export ENABLE_AUTO_LINT=true
export NO_CHANGE_TIMEOUT_SECONDS=30
export OPENHANDS_EVAL_INSTANCE_ID=django__django-15996
export OPENHANDS_EVAL_JOB_ID=1374670439
export OPENHANDS_TIMING_DIR=./continuum32/princeton-nlp__SWE-bench_Lite-test/CodeActAgent/GLM-4.6-FP8_maxiter_135/timing
export SWE_INSTANCE_ID=django__django-15996
export PIP_CACHE_DIR=~/.cache/pip
alias git='git --no-pager'
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:34,410 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
source ~/.bashrc
2026-01-06 15:20:35,028 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:35,028 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
source /swe_util/instance_swe_entry.sh
2026-01-06 15:20:37,663 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
WORKSPACE_NAME: django__django__4.2
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:37,663 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
cd /workspace/django__django__4.2
2026-01-06 15:20:38,281 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:38,281 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git reset --hard
2026-01-06 15:20:39,906 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
HEAD is now at b30c0081d4 Refs #27412 -- Confirmed support for executing Coalesce(subquery).
[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:39,906 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
for remote_name in $(git remote); do git remote remove "${remote_name}"; done
2026-01-06 15:20:40,525 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:40,526 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
which python
2026-01-06 15:20:41,145 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
/opt/miniconda3/envs/testbed/bin/python
[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:20:41,145 - INFO - ------------------------------
2026-01-06 15:20:41,145 - INFO - END Runtime Initialization Fn
2026-01-06 15:20:41,145 - INFO - ------------------------------
2026-01-06 15:20:41,148 - INFO - [LLM registry 0f710a84-45eb-4412-a215-51124babd173]: Registering service for agent
2026-01-06 15:20:41,163 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Selected repo: None, loading microagents from /workspace/.openhands/microagents (inside runtime)
2026-01-06 15:20:41,165 - INFO - [runtime 37f30b81-57bd-41-945d3077b3dc679] Attempting to list files in repository microagents directory: /workspace/.openhands/microagents
2026-01-06 15:20:41,167 - INFO - Loading user workspace microagents: []
2026-01-06 15:20:41,167 - INFO - AgentController 37f30b81-57bd-41-945d3077b3dc679 - created new state. start_id: 0
2026-01-06 15:20:41,174 - INFO - [Agent Controller 37f30b81-57bd-41-945d3077b3dc679] Setting agent(CodeActAgent) state from AgentState.LOADING to AgentState.RUNNING
2026-01-06 15:20:41,176 - INFO - Saved conversation stats
2026-01-06 15:32:49,983 - INFO - [Agent Controller 37f30b81-57bd-41-945d3077b3dc679] Setting agent(CodeActAgent) state from AgentState.RUNNING to AgentState.FINISHED
2026-01-06 15:32:49,985 - INFO - Saved conversation stats
2026-01-06 15:32:50,896 - INFO - ------------------------------
2026-01-06 15:32:50,897 - INFO - BEGIN Runtime Completion Fn
2026-01-06 15:32:50,897 - INFO - ------------------------------
2026-01-06 15:32:50,897 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
cd /workspace/django__django__4.2
2026-01-06 15:32:51,516 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:32:51,517 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git config --global core.pager ""
2026-01-06 15:32:52,136 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:32:52,137 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
find . -type d -name .git -not -path "./.git"
2026-01-06 15:32:52,756 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:32:52,762 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git add -A
2026-01-06 15:32:53,381 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:32:53,381 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
for file in $(git status --porcelain | grep -E "^(M| M|\?\?|A| A)" | cut -c4-); do
        if [ -f "$file" ] && (file "$file" | grep -q "executable" || git check-attr binary "$file" | grep -q "binary: set"); then
            git rm -f "$file" 2>/dev/null || rm -f "$file"
            echo "Removed: $file"
        fi
    done
2026-01-06 15:32:54,006 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
bash: file: command not found
bash: file: command not found
bash: file: command not found
bash: file: command not found
bash: file: command not found
bash: file: command not found
bash: file: command not found
bash: file: command not found
bash: file: command not found
[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:32:54,007 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git diff --no-color --cached b30c0081d4d8a31ab7dc7f72a4c7099af606ef29 > patch.diff
2026-01-06 15:32:54,625 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "4011f1707f5a",
  "working_dir": "/workspace/django__django__4.2",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__4.2]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:32:54,626 - INFO - FileReadAction(path='patch.diff', start=0, end=-1, thought='', action=<ActionType.READ: 'read'>, security_risk=<ActionSecurityRisk.UNKNOWN: -1>, impl_source=<FileReadSource.DEFAULT: 'default'>, view_range=None)
2026-01-06 15:32:54,628 - INFO - [Read from /workspace/django__django__4.2/patch.diff is successful.]
diff --git a/check_test_module.py b/check_test_module.py
new file mode 100644
index 0000000000..3c20284699
--- /dev/null
+++ b/check_test_module.py
@@ -0,0 +1,61 @@
+#!/usr/bin/env python3
+"""
+Check the module name of the test enum
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Setup Django
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+# Import the test enum
+import migrations.test_writer
+IntFlagEnum = migrations.test_writer.IntFlagEnum
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Testing with combined value: {combined}")
+print(f"Enum class: {IntFlagEnum}")
+print(f"Enum class module: {IntFlagEnum.__module__}")
+print(f"Enum class qualname: {IntFlagEnum.__qualname__}")
+
+# Test with MigrationWriter
+from django.db.migrations.writer import MigrationWriter
+
+mw_result_string, mw_result_imports = MigrationWriter.serialize(combined)
+print(f"MigrationWriter result string: {mw_result_string}")
+print(f"MigrationWriter result imports: {mw_result_imports}")
+
+# Expected result based on test
+expected_string = "migrations.test_writer.IntFlagEnum.B | migrations.test_writer.IntFlagEnum.A"
+expected_imports = {"import migrations.test_writer"}
+
+print(f"Expected string: {expected_string}")
+print(f"Expected imports: {expected_imports}")
+
+print(f"String matches: {mw_result_string == expected_string}")
+print(f"Imports match: {mw_result_imports == expected_imports}")
\ No newline at end of file
diff --git a/comprehensive_test.py b/comprehensive_test.py
new file mode 100644
index 0000000000..20ec47c4d9
--- /dev/null
+++ b/comprehensive_test.py
@@ -0,0 +1,109 @@
+#!/usr/bin/env python3
+"""
+Comprehensive test for Enum flag serialization fix
+"""
+
+import re
+import enum
+import os
+import sys
+import django
+from django.conf import settings
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Configure Django settings
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db import models
+from django.db.migrations.writer import MigrationWriter
+
+class TestIntFlag(enum.IntFlag):
+    A = 1
+    B = 2
+    C = 4
+    D = 8
+
+def test_various_enum_combinations():
+    """Test various enum flag combinations."""
+    print("Testing various enum flag combinations...")
+    
+    test_cases = [
+        # Single flags (should use original logic)
+        (re.UNICODE, "Single regex flag"),
+        (re.IGNORECASE, "Single regex flag"),
+        (TestIntFlag.A, "Single IntFlag"),
+        
+        # Combined flags (should use new logic)
+        (re.UNICODE | re.IGNORECASE, "Combined regex flags"),
+        (re.MULTILINE | re.DOTALL | re.IGNORECASE, "Three combined regex flags"),
+        (TestIntFlag.A | TestIntFlag.B, "Combined IntFlags"),
+        (TestIntFlag.A | TestIntFlag.C | TestIntFlag.D, "Three combined IntFlags"),
+    ]
+    
+    for value, description in test_cases:
+        print(f"\n--- {description} ---")
+        print(f"Value: {value}")
+        print(f"Type: {type(value)}")
+        print(f"Name: {getattr(value, 'name', 'NO NAME')}")
+        
+        try:
+            serialized_string, imports = MigrationWriter.serialize(value)
+            print(f"Serialized: {serialized_string}")
+            print(f"Imports: {imports}")
+            
+            # Test deserialization
+            namespace = {}
+            for imp in imports:
+                exec(imp, namespace)
+            
+            result = eval(serialized_string, namespace)
+            print(f"Deserialized: {result}")
+            print(f"Equal to original: {result == value}")
+            
+        except Exception as e:
+            print(f"ERROR: {e}")
+            import traceback
+            traceback.print_exc()
+
+def test_model_fields():
+    """Test model fields with enum flag defaults."""
+    print("\n\nTesting model fields with enum flag defaults...")
+    
+    field_cases = [
+        models.IntegerField(default=re.UNICODE | re.IGNORECASE),
+        models.IntegerField(default=TestIntFlag.A | TestIntFlag.B),
+        models.IntegerField(default=re.MULTILINE | re.DOTALL),
+    ]
+    
+    for i, field in enumerate(field_cases):
+        print(f"\n--- Field {i+1} ---")
+        try:
+            field_string, field_imports = MigrationWriter.serialize(field)
+            print(f"Field: {field_string}")
+            print(f"Imports: {field_imports}")
+        except Exception as e:
+            print(f"ERROR: {e}")
+            import traceback
+            traceback.print_exc()
+
+if __name__ == "__main__":
+    test_various_enum_combinations()
+    test_model_fields()
diff --git a/debug_enum.py b/debug_enum.py
new file mode 100644
index 0000000000..92c58995b4
--- /dev/null
+++ b/debug_enum.py
@@ -0,0 +1,64 @@
+#!/usr/bin/env python3
+"""
+Debug script to understand enum._decompose behavior
+"""
+
+import re
+import enum
+
+# Test the _decompose method
+combined_flags = re.UNICODE | re.IGNORECASE
+print(f"Combined flags: {combined_flags}")
+print(f"Type: {type(combined_flags)}")
+print(f"Value: {combined_flags.value}")
+print(f"Name: {combined_flags.name}")
+
+# Check if _decompose exists
+print(f"Has _decompose: {hasattr(re.RegexFlag, '_decompose')}")
+
+if hasattr(re.RegexFlag, '_decompose'):
+    try:
+        result = re.RegexFlag._decompose(combined_flags)
+        print(f"_decompose result: {result}")
+        print(f"_decompose type: {type(result)}")
+        if result:
+            print(f"Individual flags: {list(result)}")
+    except Exception as e:
+        print(f"Error calling _decompose: {e}")
+        import traceback
+        traceback.print_exc()
+
+# Test manual decomposition
+print("\nManual decomposition:")
+for flag in re.RegexFlag:
+    if flag != re.RegexFlag(0) and (combined_flags & flag) == flag:
+        print(f"Found flag: {flag} (name: {flag.name})")
+
+# Test the enum module directly
+print(f"\nEnum module: {enum}")
+print(f"Has _decompose in enum module: {hasattr(enum, '_decompose')}")
+
+if hasattr(enum, '_decompose'):
+    try:
+        # Try calling it as a method on the enum class
+        result = enum._decompose(re.RegexFlag, combined_flags)
+        print(f"enum._decompose result: {result}")
+        print(f"enum._decompose type: {type(result)}")
+        if result:
+            print(f"Individual flags from enum._decompose: {list(result)}")
+    except Exception as e:
+        print(f"Error calling enum._decompose: {e}")
+        import traceback
+        traceback.print_exc()
+        
+    # Also try calling it as a bound method
+    try:
+        result = re.RegexFlag._decompose(combined_flags)
+        print(f"RegexFlag._decompose result: {result}")
+        print(f"RegexFlag._decompose type: {type(result)}")
+        if result:
+            print(f"Individual flags from RegexFlag._decompose: {list(result)}")
+    except Exception as e:
+        print(f"Error calling RegexFlag._decompose: {e}")
+        import traceback
+        traceback.print_exc()
\ No newline at end of file
diff --git a/debug_intflag.py b/debug_intflag.py
new file mode 100644
index 0000000000..372e543322
--- /dev/null
+++ b/debug_intflag.py
@@ -0,0 +1,73 @@
+#!/usr/bin/env python3
+"""
+Debug the IntFlagEnum behavior
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Define the same enum as in the test
+class IntFlagEnum(enum.IntFlag):
+    A = 1
+    B = 2
+
+# Test the enum
+print(f"IntFlagEnum.A: {IntFlagEnum.A}")
+print(f"IntFlagEnum.B: {IntFlagEnum.B}")
+print(f"Type: {type(IntFlagEnum.A)}")
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Combined: {combined}")
+print(f"Combined type: {type(combined)}")
+print(f"Combined name: {combined.name}")
+print(f"Combined value: {combined.value}")
+
+# Test _decompose
+import enum as enum_module
+try:
+    flag_members, _ = enum_module._decompose(IntFlagEnum, combined)
+    print(f"_decompose result: {flag_members}")
+    if flag_members:
+        print(f"Flag names: {[flag.name for flag in flag_members]}")
+except Exception as e:
+    print(f"Error with _decompose: {e}")
+    import traceback
+    traceback.print_exc()
+
+# Test with Django serializer
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db.migrations.writer import MigrationWriter
+
+try:
+    serialized_string, imports = MigrationWriter.serialize(combined)
+    print(f"Serialized: {serialized_string}")
+    print(f"Imports: {imports}")
+except Exception as e:
+    print(f"Error during serialization: {e}")
+    import traceback
+    traceback.print_exc()
\ No newline at end of file
diff --git a/debug_test_enum.py b/debug_test_enum.py
new file mode 100644
index 0000000000..9e7c74c5dc
--- /dev/null
+++ b/debug_test_enum.py
@@ -0,0 +1,71 @@
+#!/usr/bin/env python3
+"""
+Debug the IntFlagEnum from the test file
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Import the test enum
+from tests.migrations.test_writer import IntFlagEnum
+
+# Test the enum
+print(f"IntFlagEnum.A: {IntFlagEnum.A}")
+print(f"IntFlagEnum.B: {IntFlagEnum.B}")
+print(f"Type: {type(IntFlagEnum.A)}")
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Combined: {combined}")
+print(f"Combined type: {type(combined)}")
+print(f"Combined name: {combined.name}")
+print(f"Combined value: {combined.value}")
+
+# Test _decompose
+import enum as enum_module
+try:
+    flag_members, _ = enum_module._decompose(IntFlagEnum, combined)
+    print(f"_decompose result: {flag_members}")
+    if flag_members:
+        print(f"Flag names: {[flag.name for flag in flag_members]}")
+except Exception as e:
+    print(f"Error with _decompose: {e}")
+    import traceback
+    traceback.print_exc()
+
+# Test with Django serializer
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db.migrations.writer import MigrationWriter
+
+try:
+    serialized_string, imports = MigrationWriter.serialize(combined)
+    print(f"Serialized: {serialized_string}")
+    print(f"Imports: {imports}")
+except Exception as e:
+    print(f"Error during serialization: {e}")
+    import traceback
+    traceback.print_exc()
\ No newline at end of file
diff --git a/direct_test.py b/direct_test.py
new file mode 100644
index 0000000000..c6ea5c2e00
--- /dev/null
+++ b/direct_test.py
@@ -0,0 +1,70 @@
+#!/usr/bin/env python3
+"""
+Direct test of the EnumSerializer
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Define the same enum as in the test
+class IntFlagEnum(enum.IntFlag):
+    A = 1
+    B = 2
+
+# Setup Django
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+# Import the serializer directly
+from django.db.migrations.serializer import EnumSerializer
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Testing with combined value: {combined}")
+print(f"Name: {combined.name}")
+
+# Create serializer and test
+serializer = EnumSerializer(combined)
+result_string, result_imports = serializer.serialize()
+
+print(f"Result string: {result_string}")
+print(f"Result imports: {result_imports}")
+
+# Expected result
+expected_string = "__main__.IntFlagEnum.B | __main__.IntFlagEnum.A"
+expected_imports = {"import __main__"}
+
+print(f"Expected string: {expected_string}")
+print(f"Expected imports: {expected_imports}")
+
+print(f"String matches: {result_string == expected_string}")
+print(f"Imports match: {result_imports == expected_imports}")
+
+# Test with MigrationWriter too
+from django.db.migrations.writer import MigrationWriter
+
+mw_result_string, mw_result_imports = MigrationWriter.serialize(combined)
+print(f"\nMigrationWriter result string: {mw_result_string}")
+print(f"MigrationWriter result imports: {mw_result_imports}")
\ No newline at end of file
diff --git a/django/db/migrations/serializer.py b/django/db/migrations/serializer.py
index 38da1e6ecc..6c975e924e 100644
--- a/django/db/migrations/serializer.py
+++ b/django/db/migrations/serializer.py
@@ -125,6 +125,21 @@ class EnumSerializer(BaseSerializer):
     def serialize(self):
         enum_class = self.value.__class__
         module = enum_class.__module__
+        
+        # Handle combined enum flags (where name is None)
+        if self.value.name is None:
+            # Use enum._decompose to get individual flag names
+            try:
+                flag_members, _ = enum._decompose(enum_class, self.value)
+                if flag_members:
+                    # Create an expression that ORs together the individual flags
+                    flag_refs = ["%s.%s.%s" % (module, enum_class.__qualname__, flag.name) for flag in flag_members]
+                    return " | ".join(flag_refs), {"import %s" % module}
+            except (AttributeError, ValueError, TypeError):
+                # Fallback if _decompose is not available or fails
+                pass
+        
+        # Original logic for single enum values
         return (
             "%s.%s[%r]" % (module, enum_class.__qualname__, self.value.name),
             {"import %s" % module},
diff --git a/reproduce_issue.py b/reproduce_issue.py
new file mode 100644
index 0000000000..18a35ccb64
--- /dev/null
+++ b/reproduce_issue.py
@@ -0,0 +1,93 @@
+#!/usr/bin/env python3
+"""
+Script to reproduce the Enum flag serialization issue.
+
+The issue: When using a combination of Enum flags as a default value in a Django model,
+the migration serializer produces `re.RegexFlag[None]` instead of a proper expression
+that reconstructs the flag combination.
+"""
+
+import re
+import os
+import sys
+import django
+from django.conf import settings
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Configure Django settings
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db import models
+from django.db.migrations.writer import MigrationWriter
+
+# Create a test model with combined regex flags
+class TestModel(models.Model):
+    # This is the problematic case from the issue description
+    regex_flags = models.IntegerField(default=re.UNICODE | re.IGNORECASE)
+    
+    class Meta:
+        app_label = 'test_app'
+
+def test_enum_flag_serialization():
+    """Test the serialization of combined enum flags."""
+    print("Testing Enum flag serialization...")
+    
+    # Test the problematic case
+    combined_flags = re.UNICODE | re.IGNORECASE
+    print(f"Original combined flags: {combined_flags}")
+    print(f"Combined flags type: {type(combined_flags)}")
+    print(f"Combined flags value: {combined_flags.value}")
+    print(f"Combined flags name: {getattr(combined_flags, 'name', 'NO NAME')}")
+    
+    # Try to serialize it using Django's migration writer
+    try:
+        serialized_string, imports = MigrationWriter.serialize(combined_flags)
+        print(f"Serialized string: {serialized_string}")
+        print(f"Imports: {imports}")
+        
+        # Try to execute the serialized string to see if it works
+        namespace = {}
+        for imp in imports:
+            exec(imp, namespace)
+        
+        result = eval(serialized_string, namespace)
+        print(f"Deserialized result: {result}")
+        print(f"Result equals original: {result == combined_flags}")
+        
+    except Exception as e:
+        print(f"Error during serialization: {e}")
+        import traceback
+        traceback.print_exc()
+    
+    # Test with a model field
+    print("\nTesting with model field...")
+    field = models.IntegerField(default=re.UNICODE | re.IGNORECASE)
+    try:
+        field_string, field_imports = MigrationWriter.serialize(field)
+        print(f"Field serialized: {field_string}")
+        print(f"Field imports: {field_imports}")
+    except Exception as e:
+        print(f"Error during field serialization: {e}")
+        import traceback
+        traceback.print_exc()
+
+if __name__ == "__main__":
+    test_enum_flag_serialization()
diff --git a/tests/migrations/test_writer.py b/tests/migrations/test_writer.py
index bad8775d4e..0831c85b80 100644
--- a/tests/migrations/test_writer.py
+++ b/tests/migrations/test_writer.py
@@ -402,6 +402,15 @@ class WriterTests(SimpleTestCase):
                 {"import migrations.test_writer"},
             ),
         )
+        # Test combined enum flags (the main fix)
+        combined_flags = IntFlagEnum.A | IntFlagEnum.B
+        self.assertSerializedResultEqual(
+            combined_flags,
+            (
+                "migrations.test_writer.IntFlagEnum.B | migrations.test_writer.IntFlagEnum.A",
+                {"import migrations.test_writer"},
+            ),
+        )
         field = models.IntegerField(
             default=IntFlagEnum.A, choices=[(m.value, m) for m in IntFlagEnum]
         )
@@ -413,6 +422,13 @@ class WriterTests(SimpleTestCase):
             "(2, migrations.test_writer.IntFlagEnum['B'])], "
             "default=migrations.test_writer.IntFlagEnum['A'])",
         )
+        # Test model field with combined enum flags
+        field_with_combined = models.IntegerField(default=IntFlagEnum.A | IntFlagEnum.B)
+        string = MigrationWriter.serialize(field_with_combined)[0]
+        self.assertEqual(
+            string,
+            "models.IntegerField(default=migrations.test_writer.IntFlagEnum.B | migrations.test_writer.IntFlagEnum.A)",
+        )
 
     def test_serialize_choices(self):
         class TextChoices(models.TextChoices):

2026-01-06 15:32:54,629 - INFO - ------------------------------
2026-01-06 15:32:54,629 - INFO - END Runtime Completion Fn
2026-01-06 15:32:54,629 - INFO - ------------------------------
2026-01-06 15:32:54,629 - INFO - Got git diff for instance django__django-15996:
--------
diff --git a/check_test_module.py b/check_test_module.py
new file mode 100644
index 0000000000..3c20284699
--- /dev/null
+++ b/check_test_module.py
@@ -0,0 +1,61 @@
+#!/usr/bin/env python3
+"""
+Check the module name of the test enum
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Setup Django
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+# Import the test enum
+import migrations.test_writer
+IntFlagEnum = migrations.test_writer.IntFlagEnum
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Testing with combined value: {combined}")
+print(f"Enum class: {IntFlagEnum}")
+print(f"Enum class module: {IntFlagEnum.__module__}")
+print(f"Enum class qualname: {IntFlagEnum.__qualname__}")
+
+# Test with MigrationWriter
+from django.db.migrations.writer import MigrationWriter
+
+mw_result_string, mw_result_imports = MigrationWriter.serialize(combined)
+print(f"MigrationWriter result string: {mw_result_string}")
+print(f"MigrationWriter result imports: {mw_result_imports}")
+
+# Expected result based on test
+expected_string = "migrations.test_writer.IntFlagEnum.B | migrations.test_writer.IntFlagEnum.A"
+expected_imports = {"import migrations.test_writer"}
+
+print(f"Expected string: {expected_string}")
+print(f"Expected imports: {expected_imports}")
+
+print(f"String matches: {mw_result_string == expected_string}")
+print(f"Imports match: {mw_result_imports == expected_imports}")
\ No newline at end of file
diff --git a/comprehensive_test.py b/comprehensive_test.py
new file mode 100644
index 0000000000..20ec47c4d9
--- /dev/null
+++ b/comprehensive_test.py
@@ -0,0 +1,109 @@
+#!/usr/bin/env python3
+"""
+Comprehensive test for Enum flag serialization fix
+"""
+
+import re
+import enum
+import os
+import sys
+import django
+from django.conf import settings
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Configure Django settings
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db import models
+from django.db.migrations.writer import MigrationWriter
+
+class TestIntFlag(enum.IntFlag):
+    A = 1
+    B = 2
+    C = 4
+    D = 8
+
+def test_various_enum_combinations():
+    """Test various enum flag combinations."""
+    print("Testing various enum flag combinations...")
+    
+    test_cases = [
+        # Single flags (should use original logic)
+        (re.UNICODE, "Single regex flag"),
+        (re.IGNORECASE, "Single regex flag"),
+        (TestIntFlag.A, "Single IntFlag"),
+        
+        # Combined flags (should use new logic)
+        (re.UNICODE | re.IGNORECASE, "Combined regex flags"),
+        (re.MULTILINE | re.DOTALL | re.IGNORECASE, "Three combined regex flags"),
+        (TestIntFlag.A | TestIntFlag.B, "Combined IntFlags"),
+        (TestIntFlag.A | TestIntFlag.C | TestIntFlag.D, "Three combined IntFlags"),
+    ]
+    
+    for value, description in test_cases:
+        print(f"\n--- {description} ---")
+        print(f"Value: {value}")
+        print(f"Type: {type(value)}")
+        print(f"Name: {getattr(value, 'name', 'NO NAME')}")
+        
+        try:
+            serialized_string, imports = MigrationWriter.serialize(value)
+            print(f"Serialized: {serialized_string}")
+            print(f"Imports: {imports}")
+            
+            # Test deserialization
+            namespace = {}
+            for imp in imports:
+                exec(imp, namespace)
+            
+            result = eval(serialized_string, namespace)
+            print(f"Deserialized: {result}")
+            print(f"Equal to original: {result == value}")
+            
+        except Exception as e:
+            print(f"ERROR: {e}")
+            import traceback
+            traceback.print_exc()
+
+def test_model_fields():
+    """Test model fields with enum flag defaults."""
+    print("\n\nTesting model fields with enum flag defaults...")
+    
+    field_cases = [
+        models.IntegerField(default=re.UNICODE | re.IGNORECASE),
+        models.IntegerField(default=TestIntFlag.A | TestIntFlag.B),
+        models.IntegerField(default=re.MULTILINE | re.DOTALL),
+    ]
+    
+    for i, field in enumerate(field_cases):
+        print(f"\n--- Field {i+1} ---")
+        try:
+            field_string, field_imports = MigrationWriter.serialize(field)
+            print(f"Field: {field_string}")
+            print(f"Imports: {field_imports}")
+        except Exception as e:
+            print(f"ERROR: {e}")
+            import traceback
+            traceback.print_exc()
+
+if __name__ == "__main__":
+    test_various_enum_combinations()
+    test_model_fields()
diff --git a/debug_enum.py b/debug_enum.py
new file mode 100644
index 0000000000..92c58995b4
--- /dev/null
+++ b/debug_enum.py
@@ -0,0 +1,64 @@
+#!/usr/bin/env python3
+"""
+Debug script to understand enum._decompose behavior
+"""
+
+import re
+import enum
+
+# Test the _decompose method
+combined_flags = re.UNICODE | re.IGNORECASE
+print(f"Combined flags: {combined_flags}")
+print(f"Type: {type(combined_flags)}")
+print(f"Value: {combined_flags.value}")
+print(f"Name: {combined_flags.name}")
+
+# Check if _decompose exists
+print(f"Has _decompose: {hasattr(re.RegexFlag, '_decompose')}")
+
+if hasattr(re.RegexFlag, '_decompose'):
+    try:
+        result = re.RegexFlag._decompose(combined_flags)
+        print(f"_decompose result: {result}")
+        print(f"_decompose type: {type(result)}")
+        if result:
+            print(f"Individual flags: {list(result)}")
+    except Exception as e:
+        print(f"Error calling _decompose: {e}")
+        import traceback
+        traceback.print_exc()
+
+# Test manual decomposition
+print("\nManual decomposition:")
+for flag in re.RegexFlag:
+    if flag != re.RegexFlag(0) and (combined_flags & flag) == flag:
+        print(f"Found flag: {flag} (name: {flag.name})")
+
+# Test the enum module directly
+print(f"\nEnum module: {enum}")
+print(f"Has _decompose in enum module: {hasattr(enum, '_decompose')}")
+
+if hasattr(enum, '_decompose'):
+    try:
+        # Try calling it as a method on the enum class
+        result = enum._decompose(re.RegexFlag, combined_flags)
+        print(f"enum._decompose result: {result}")
+        print(f"enum._decompose type: {type(result)}")
+        if result:
+            print(f"Individual flags from enum._decompose: {list(result)}")
+    except Exception as e:
+        print(f"Error calling enum._decompose: {e}")
+        import traceback
+        traceback.print_exc()
+        
+    # Also try calling it as a bound method
+    try:
+        result = re.RegexFlag._decompose(combined_flags)
+        print(f"RegexFlag._decompose result: {result}")
+        print(f"RegexFlag._decompose type: {type(result)}")
+        if result:
+            print(f"Individual flags from RegexFlag._decompose: {list(result)}")
+    except Exception as e:
+        print(f"Error calling RegexFlag._decompose: {e}")
+        import traceback
+        traceback.print_exc()
\ No newline at end of file
diff --git a/debug_intflag.py b/debug_intflag.py
new file mode 100644
index 0000000000..372e543322
--- /dev/null
+++ b/debug_intflag.py
@@ -0,0 +1,73 @@
+#!/usr/bin/env python3
+"""
+Debug the IntFlagEnum behavior
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Define the same enum as in the test
+class IntFlagEnum(enum.IntFlag):
+    A = 1
+    B = 2
+
+# Test the enum
+print(f"IntFlagEnum.A: {IntFlagEnum.A}")
+print(f"IntFlagEnum.B: {IntFlagEnum.B}")
+print(f"Type: {type(IntFlagEnum.A)}")
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Combined: {combined}")
+print(f"Combined type: {type(combined)}")
+print(f"Combined name: {combined.name}")
+print(f"Combined value: {combined.value}")
+
+# Test _decompose
+import enum as enum_module
+try:
+    flag_members, _ = enum_module._decompose(IntFlagEnum, combined)
+    print(f"_decompose result: {flag_members}")
+    if flag_members:
+        print(f"Flag names: {[flag.name for flag in flag_members]}")
+except Exception as e:
+    print(f"Error with _decompose: {e}")
+    import traceback
+    traceback.print_exc()
+
+# Test with Django serializer
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db.migrations.writer import MigrationWriter
+
+try:
+    serialized_string, imports = MigrationWriter.serialize(combined)
+    print(f"Serialized: {serialized_string}")
+    print(f"Imports: {imports}")
+except Exception as e:
+    print(f"Error during serialization: {e}")
+    import traceback
+    traceback.print_exc()
\ No newline at end of file
diff --git a/debug_test_enum.py b/debug_test_enum.py
new file mode 100644
index 0000000000..9e7c74c5dc
--- /dev/null
+++ b/debug_test_enum.py
@@ -0,0 +1,71 @@
+#!/usr/bin/env python3
+"""
+Debug the IntFlagEnum from the test file
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Import the test enum
+from tests.migrations.test_writer import IntFlagEnum
+
+# Test the enum
+print(f"IntFlagEnum.A: {IntFlagEnum.A}")
+print(f"IntFlagEnum.B: {IntFlagEnum.B}")
+print(f"Type: {type(IntFlagEnum.A)}")
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Combined: {combined}")
+print(f"Combined type: {type(combined)}")
+print(f"Combined name: {combined.name}")
+print(f"Combined value: {combined.value}")
+
+# Test _decompose
+import enum as enum_module
+try:
+    flag_members, _ = enum_module._decompose(IntFlagEnum, combined)
+    print(f"_decompose result: {flag_members}")
+    if flag_members:
+        print(f"Flag names: {[flag.name for flag in flag_members]}")
+except Exception as e:
+    print(f"Error with _decompose: {e}")
+    import traceback
+    traceback.print_exc()
+
+# Test with Django serializer
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db.migrations.writer import MigrationWriter
+
+try:
+    serialized_string, imports = MigrationWriter.serialize(combined)
+    print(f"Serialized: {serialized_string}")
+    print(f"Imports: {imports}")
+except Exception as e:
+    print(f"Error during serialization: {e}")
+    import traceback
+    traceback.print_exc()
\ No newline at end of file
diff --git a/direct_test.py b/direct_test.py
new file mode 100644
index 0000000000..c6ea5c2e00
--- /dev/null
+++ b/direct_test.py
@@ -0,0 +1,70 @@
+#!/usr/bin/env python3
+"""
+Direct test of the EnumSerializer
+"""
+
+import enum
+import sys
+import os
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Define the same enum as in the test
+class IntFlagEnum(enum.IntFlag):
+    A = 1
+    B = 2
+
+# Setup Django
+import django
+from django.conf import settings
+
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+# Import the serializer directly
+from django.db.migrations.serializer import EnumSerializer
+
+# Test combined flags
+combined = IntFlagEnum.A | IntFlagEnum.B
+print(f"Testing with combined value: {combined}")
+print(f"Name: {combined.name}")
+
+# Create serializer and test
+serializer = EnumSerializer(combined)
+result_string, result_imports = serializer.serialize()
+
+print(f"Result string: {result_string}")
+print(f"Result imports: {result_imports}")
+
+# Expected result
+expected_string = "__main__.IntFlagEnum.B | __main__.IntFlagEnum.A"
+expected_imports = {"import __main__"}
+
+print(f"Expected string: {expected_string}")
+print(f"Expected imports: {expected_imports}")
+
+print(f"String matches: {result_string == expected_string}")
+print(f"Imports match: {result_imports == expected_imports}")
+
+# Test with MigrationWriter too
+from django.db.migrations.writer import MigrationWriter
+
+mw_result_string, mw_result_imports = MigrationWriter.serialize(combined)
+print(f"\nMigrationWriter result string: {mw_result_string}")
+print(f"MigrationWriter result imports: {mw_result_imports}")
\ No newline at end of file
diff --git a/django/db/migrations/serializer.py b/django/db/migrations/serializer.py
index 38da1e6ecc..6c975e924e 100644
--- a/django/db/migrations/serializer.py
+++ b/django/db/migrations/serializer.py
@@ -125,6 +125,21 @@ class EnumSerializer(BaseSerializer):
     def serialize(self):
         enum_class = self.value.__class__
         module = enum_class.__module__
+        
+        # Handle combined enum flags (where name is None)
+        if self.value.name is None:
+            # Use enum._decompose to get individual flag names
+            try:
+                flag_members, _ = enum._decompose(enum_class, self.value)
+                if flag_members:
+                    # Create an expression that ORs together the individual flags
+                    flag_refs = ["%s.%s.%s" % (module, enum_class.__qualname__, flag.name) for flag in flag_members]
+                    return " | ".join(flag_refs), {"import %s" % module}
+            except (AttributeError, ValueError, TypeError):
+                # Fallback if _decompose is not available or fails
+                pass
+        
+        # Original logic for single enum values
         return (
             "%s.%s[%r]" % (module, enum_class.__qualname__, self.value.name),
             {"import %s" % module},
diff --git a/reproduce_issue.py b/reproduce_issue.py
new file mode 100644
index 0000000000..18a35ccb64
--- /dev/null
+++ b/reproduce_issue.py
@@ -0,0 +1,93 @@
+#!/usr/bin/env python3
+"""
+Script to reproduce the Enum flag serialization issue.
+
+The issue: When using a combination of Enum flags as a default value in a Django model,
+the migration serializer produces `re.RegexFlag[None]` instead of a proper expression
+that reconstructs the flag combination.
+"""
+
+import re
+import os
+import sys
+import django
+from django.conf import settings
+
+# Add the Django path to sys.path
+sys.path.insert(0, '/workspace/django__django__4.2')
+
+# Configure Django settings
+if not settings.configured:
+    settings.configure(
+        DEBUG=True,
+        DATABASES={
+            'default': {
+                'ENGINE': 'django.db.backends.sqlite3',
+                'NAME': ':memory:',
+            }
+        },
+        INSTALLED_APPS=[
+            'django.contrib.contenttypes',
+            'django.contrib.auth',
+        ],
+        SECRET_KEY='test-secret-key-for-reproduction',
+    )
+
+django.setup()
+
+from django.db import models
+from django.db.migrations.writer import MigrationWriter
+
+# Create a test model with combined regex flags
+class TestModel(models.Model):
+    # This is the problematic case from the issue description
+    regex_flags = models.IntegerField(default=re.UNICODE | re.IGNORECASE)
+    
+    class Meta:
+        app_label = 'test_app'
+
+def test_enum_flag_serialization():
+    """Test the serialization of combined enum flags."""
+    print("Testing Enum flag serialization...")
+    
+    # Test the problematic case
+    combined_flags = re.UNICODE | re.IGNORECASE
+    print(f"Original combined flags: {combined_flags}")
+    print(f"Combined flags type: {type(combined_flags)}")
+    print(f"Combined flags value: {combined_flags.value}")
+    print(f"Combined flags name: {getattr(combined_flags, 'name', 'NO NAME')}")
+    
+    # Try to serialize it using Django's migration writer
+    try:
+        serialized_string, imports = MigrationWriter.serialize(combined_flags)
+        print(f"Serialized string: {serialized_string}")
+        print(f"Imports: {imports}")
+        
+        # Try to execute the serialized string to see if it works
+        namespace = {}
+        for imp in imports:
+            exec(imp, namespace)
+        
+        result = eval(serialized_string, namespace)
+        print(f"Deserialized result: {result}")
+        print(f"Result equals original: {result == combined_flags}")
+        
+    except Exception as e:
+        print(f"Error during serialization: {e}")
+        import traceback
+        traceback.print_exc()
+    
+    # Test with a model field
+    print("\nTesting with model field...")
+    field = models.IntegerField(default=re.UNICODE | re.IGNORECASE)
+    try:
+        field_string, field_imports = MigrationWriter.serialize(field)
+        print(f"Field serialized: {field_string}")
+        print(f"Field imports: {field_imports}")
+    except Exception as e:
+        print(f"Error during field serialization: {e}")
+        import traceback
+        traceback.print_exc()
+
+if __name__ == "__main__":
+    test_enum_flag_serialization()
diff --git a/tests/migrations/test_writer.py b/tests/migrations/test_writer.py
index bad8775d4e..0831c85b80 100644
--- a/tests/migrations/test_writer.py
+++ b/tests/migrations/test_writer.py
@@ -402,6 +402,15 @@ class WriterTests(SimpleTestCase):
                 {"import migrations.test_writer"},
             ),
         )
+        # Test combined enum flags (the main fix)
+        combined_flags = IntFlagEnum.A | IntFlagEnum.B
+        self.assertSerializedResultEqual(
+            combined_flags,
+            (
+                "migrations.test_writer.IntFlagEnum.B | migrations.test_writer.IntFlagEnum.A",
+                {"import migrations.test_writer"},
+            ),
+        )
         field = models.IntegerField(
             default=IntFlagEnum.A, choices=[(m.value, m) for m in IntFlagEnum]
         )
@@ -413,6 +422,13 @@ class WriterTests(SimpleTestCase):
             "(2, migrations.test_writer.IntFlagEnum['B'])], "
             "default=migrations.test_writer.IntFlagEnum['A'])",
         )
+        # Test model field with combined enum flags
+        field_with_combined = models.IntegerField(default=IntFlagEnum.A | IntFlagEnum.B)
+        string = MigrationWriter.serialize(field_with_combined)[0]
+        self.assertEqual(
+            string,
+            "models.IntegerField(default=migrations.test_writer.IntFlagEnum.B | migrations.test_writer.IntFlagEnum.A)",
+        )
 
     def test_serialize_choices(self):
         class TextChoices(models.TextChoices):
--------
2026-01-06 15:32:59,597 - INFO - Using instance container image: docker.io/swebench/sweb.eval.x86_64.matplotlib_1776_matplotlib-25311:latest. Please make sure this image exists. Submit an issue on https://github.com/OpenHands/OpenHands if you run into any issues.
2026-01-06 15:32:59,597 - INFO - Resource mapping for princeton-nlp__SWE-bench_Lite-test not found.
2026-01-06 15:32:59,598 - INFO - Logging LLM completions for instance matplotlib__matplotlib-25311 to ./continuum32/princeton-nlp__SWE-bench_Lite-test/CodeActAgent/GLM-4.6-FP8_maxiter_135/llm_completions/matplotlib__matplotlib-25311
2026-01-06 15:32:59,598 - INFO - Config file not found: config.toml. Error: [Errno 2] No such file or directory: 'config.toml'
2026-01-06 15:32:59,598 - INFO - Config file not found: [Errno 2] No such file or directory: 'config.toml'. Toml values have not been applied.
