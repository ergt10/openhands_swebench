2026-01-06 15:22:58,915 - INFO - [LLM registry 1b42452c-684a-414e-85d7-c7fadd26467f]: Registering service for agent
2026-01-06 15:22:58,951 - INFO - Building image: ghcr.io/openhands/runtime:oh_v1.0.0_sknckx6qgiret43o_v008aov5t6vw3gr5
2026-01-06 15:30:20,093 - INFO - Image [ghcr.io/openhands/runtime:oh_v1.0.0_sknckx6qgiret43o_v008aov5t6vw3gr5] build finished.
2026-01-06 15:30:20,101 - INFO - Re-tagged image [ghcr.io/openhands/runtime:oh_v1.0.0_sknckx6qgiret43o_v008aov5t6vw3gr5] with more generic tag [oh_v1.0.0_sknckx6qgiret43o]
2026-01-06 15:30:20,102 - INFO - Image ghcr.io/openhands/runtime with tags [oh_v1.0.0_sknckx6qgiret43o_v008aov5t6vw3gr5, oh_v1.0.0_sknckx6qgiret43o] built successfully
2026-01-06 15:30:20,147 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Starting runtime with image: ghcr.io/openhands/runtime:oh_v1.0.0_sknckx6qgiret43o_v008aov5t6vw3gr5
2026-01-06 15:30:20,250 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Starting server with command: ['/openhands/micromamba/bin/micromamba', 'run', '-n', 'openhands', 'poetry', 'run', 'python', '-u', '-m', 'openhands.runtime.action_execution_server', '35964', '--working-dir', '/workspace', '--plugins', 'agent_skills', 'jupyter', '--username', 'root', '--user-id', '0', '--no-enable-browser']
2026-01-06 15:30:20,710 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Container started: openhands-runtime-bc55ebb0-53ad-45-a751dacacab4901. VSCode URL: None
2026-01-06 15:30:20,710 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Waiting for client to become ready at http://localhost:35964...
2026-01-06 15:30:48,815 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Runtime is ready.
2026-01-06 15:30:51,930 - INFO - Successfully configured git: name=openhands, email=openhands@all-hands.dev
2026-01-06 15:30:51,931 - INFO - ------------------------------
2026-01-06 15:30:51,931 - INFO - BEGIN Runtime Initialization Fn
2026-01-06 15:30:51,931 - INFO - ------------------------------
2026-01-06 15:30:51,932 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
echo 'export SWE_INSTANCE_ID=django__django-16527' >> ~/.bashrc && echo 'export PIP_CACHE_DIR=~/.cache/pip' >> ~/.bashrc && echo "alias git='git --no-pager'" >> ~/.bashrc && git config --global core.pager "" && git config --global diff.binary false
2026-01-06 15:30:52,551 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:52,551 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
export USER=$(whoami); echo USER=${USER} 
2026-01-06 15:30:53,171 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
USER=root
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:53,172 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
mkdir -p /swe_util/eval_data/instances
2026-01-06 15:30:53,791 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:53,805 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
cat ~/.bashrc
2026-01-06 15:30:54,430 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
source /opt/miniconda3/etc/profile.d/conda.sh && conda activate testbed

. "/openhands/bin/env"
export PATH="/usr/bin:/bin:/usr/sbin:/sbin:/openhands/micromamba/bin:$PATH"
export PLAYWRIGHT_BROWSERS_PATH=/opt/playwright-browsers
eval "$(/openhands/micromamba/bin/micromamba shell hook --shell bash)"
micromamba activate openhands 2>/dev/null || true
export ENABLE_AUTO_LINT=true
export NO_CHANGE_TIMEOUT_SECONDS=30
export OPENHANDS_EVAL_INSTANCE_ID=django__django-16527
export OPENHANDS_EVAL_JOB_ID=3736302000
export OPENHANDS_TIMING_DIR=./continuum32/princeton-nlp__SWE-bench_Lite-test/CodeActAgent/GLM-4.6-FP8_maxiter_135/timing
export SWE_INSTANCE_ID=django__django-16527
export PIP_CACHE_DIR=~/.cache/pip
alias git='git --no-pager'
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:54,430 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
source ~/.bashrc
2026-01-06 15:30:55,049 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace",
  "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /openhands/micromamba/envs/openhands/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:55,049 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
source /swe_util/instance_swe_entry.sh
2026-01-06 15:30:56,673 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
WORKSPACE_NAME: django__django__5.0
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:56,674 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
cd /workspace/django__django__5.0
2026-01-06 15:30:57,297 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:57,297 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git reset --hard
2026-01-06 15:30:58,928 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
Updating files: 100% (6648/6648), done.
HEAD is now at 3c984cd15a SWE-bench
[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:58,928 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
for remote_name in $(git remote); do git remote remove "${remote_name}"; done
2026-01-06 15:30:59,549 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:30:59,549 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
which python
2026-01-06 15:31:00,168 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
/opt/miniconda3/envs/testbed/bin/python
[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:31:00,168 - INFO - ------------------------------
2026-01-06 15:31:00,169 - INFO - END Runtime Initialization Fn
2026-01-06 15:31:00,169 - INFO - ------------------------------
2026-01-06 15:31:00,171 - INFO - [LLM registry 81752e7c-5973-4d99-8321-69660343deea]: Registering service for agent
2026-01-06 15:31:00,186 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Selected repo: None, loading microagents from /workspace/.openhands/microagents (inside runtime)
2026-01-06 15:31:00,189 - INFO - [runtime bc55ebb0-53ad-45-a751dacacab4901] Attempting to list files in repository microagents directory: /workspace/.openhands/microagents
2026-01-06 15:31:00,191 - INFO - Loading user workspace microagents: []
2026-01-06 15:31:00,191 - INFO - AgentController bc55ebb0-53ad-45-a751dacacab4901 - created new state. start_id: 0
2026-01-06 15:31:00,198 - INFO - [Agent Controller bc55ebb0-53ad-45-a751dacacab4901] Setting agent(CodeActAgent) state from AgentState.LOADING to AgentState.RUNNING
2026-01-06 15:31:00,200 - INFO - Saved conversation stats
2026-01-06 15:42:42,668 - INFO - [Agent Controller bc55ebb0-53ad-45-a751dacacab4901] Setting agent(CodeActAgent) state from AgentState.RUNNING to AgentState.FINISHED
2026-01-06 15:42:42,669 - INFO - Saved conversation stats
2026-01-06 15:42:43,403 - INFO - ------------------------------
2026-01-06 15:42:43,403 - INFO - BEGIN Runtime Completion Fn
2026-01-06 15:42:43,404 - INFO - ------------------------------
2026-01-06 15:42:43,404 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
cd /workspace/django__django__5.0
2026-01-06 15:42:44,027 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:42:44,027 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git config --global core.pager ""
2026-01-06 15:42:44,651 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:42:44,655 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
find . -type d -name .git -not -path "./.git"
2026-01-06 15:42:45,285 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:42:45,286 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git add -A
2026-01-06 15:42:45,910 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:42:45,910 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
for file in $(git status --porcelain | grep -E "^(M| M|\?\?|A| A)" | cut -c4-); do
        if [ -f "$file" ] && (file "$file" | grep -q "executable" || git check-attr binary "$file" | grep -q "binary: set"); then
            git rm -f "$file" 2>/dev/null || rm -f "$file"
            echo "Removed: $file"
        fi
    done
2026-01-06 15:42:46,535 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
bash: file: command not found
bash: file: command not found
[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:42:46,535 - INFO - **CmdRunAction (source=None, is_input=False)**
COMMAND:
git diff --no-color --cached bd366ca2aeffa869b7dbc0b0aa01caea75e6dc31 > patch.diff
2026-01-06 15:42:47,165 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "9612ea945b35",
  "working_dir": "/workspace/django__django__5.0",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/django__django__5.0]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
[Command finished with exit code 0]
--END AGENT OBSERVATION--
2026-01-06 15:42:47,166 - INFO - FileReadAction(path='patch.diff', start=0, end=-1, thought='', action=<ActionType.READ: 'read'>, security_risk=<ActionSecurityRisk.UNKNOWN: -1>, impl_source=<FileReadSource.DEFAULT: 'default'>, view_range=None)
2026-01-06 15:42:47,169 - INFO - [Read from /workspace/django__django__5.0/patch.diff is successful.]
diff --git a/django/contrib/admin/templatetags/admin_modify.py b/django/contrib/admin/templatetags/admin_modify.py
index 9df4b7aadb..5b742af46a 100644
--- a/django/contrib/admin/templatetags/admin_modify.py
+++ b/django/contrib/admin/templatetags/admin_modify.py
@@ -100,6 +100,7 @@ def submit_row(context):
                 and context.get("show_delete", True)
             ),
             "show_save_as_new": not is_popup
+            and has_add_permission
             and has_change_permission
             and change
             and save_as,
diff --git a/tests/admin_views/tests.py b/tests/admin_views/tests.py
index 03ab9a9454..f7fadff4ab 100644
--- a/tests/admin_views/tests.py
+++ b/tests/admin_views/tests.py
@@ -1862,6 +1862,105 @@ class SaveAsTests(TestCase):
         self.assertFalse(response.context["show_save_and_continue"])
         self.assertTrue(response.context["show_save_as_new"])
 
+    def test_save_as_new_permission_issue(self):
+        """
+        Test that demonstrates the issue: show_save_as_new appears even when user
+        doesn't have add permission, only change permission.
+        """
+        # Create a test person object
+        person = Person.objects.create(name='Test Person', gender=1)
+        
+        # Create a regular user with only change permission, not add permission
+        user = User.objects.create_user(username='testuser', password='testpass', is_staff=True)
+        
+        # Get the content type for Person model
+        person_ct = ContentType.objects.get_for_model(Person)
+        
+        # Give the user only change permission, not add permission
+        change_perm = Permission.objects.get(
+            content_type=person_ct,
+            codename='change_person'
+        )
+        user.user_permissions.add(change_perm)
+        
+        # Also give view permission so they can access the admin
+        view_perm = Permission.objects.get(
+            content_type=person_ct,
+            codename='view_person'
+        )
+        user.user_permissions.add(view_perm)
+        
+        # Set up client and login
+        self.client.force_login(user)
+        
+        # Get the change form for the person
+        url = reverse('admin:admin_views_person_change', args=[person.pk])
+        response = self.client.get(url)
+        
+        # Check that we got a successful response
+        self.assertEqual(response.status_code, 200, f"Expected 200, got {response.status_code}")
+        
+        # Check the context variables
+        context = response.context
+        
+        # The issue: show_save_as_new should be False when has_add_permission is False
+        # But currently it's True because it doesn't check has_add_permission
+        has_add = context.get('has_add_permission', False)
+        has_change = context.get('has_change_permission', False)
+        show_save_as_new = context.get('show_save_as_new', False)
+        
+        # This test verifies the fix: show_save_as_new should be False when user doesn't have add permission
+        self.assertFalse(has_add, "User should not have add permission")
+        self.assertTrue(has_change, "User should have change permission")
+        self.assertFalse(
+            show_save_as_new, 
+            "show_save_as_new should be False when user doesn't have add permission"
+        )
+
+    def test_save_as_new_permission_comprehensive(self):
+        """
+        Comprehensive test to verify show_save_as_new behavior with different permission combinations.
+        """
+        # Create a test person object
+        person = Person.objects.create(name='Test Person', gender=1)
+        
+        # Test Case 1: User with both add and change permissions should see save_as_new
+        user_with_both = User.objects.create_user(username='user_both', password='testpass', is_staff=True)
+        person_ct = ContentType.objects.get_for_model(Person)
+        add_perm = Permission.objects.get(content_type=person_ct, codename='add_person')
+        change_perm = Permission.objects.get(content_type=person_ct, codename='change_person')
+        view_perm = Permission.objects.get(content_type=person_ct, codename='view_person')
+        user_with_both.user_permissions.add(add_perm, change_perm, view_perm)
+        
+        self.client.force_login(user_with_both)
+        response = self.client.get(reverse('admin:admin_views_person_change', args=[person.pk]))
+        self.assertEqual(response.status_code, 200)
+        self.assertTrue(response.context['has_add_permission'])
+        self.assertTrue(response.context['has_change_permission'])
+        self.assertTrue(response.context['show_save_as_new'])
+        
+        # Test Case 2: User with only change permission should NOT see save_as_new
+        user_change_only = User.objects.create_user(username='user_change', password='testpass', is_staff=True)
+        user_change_only.user_permissions.add(change_perm, view_perm)
+        
+        self.client.force_login(user_change_only)
+        response = self.client.get(reverse('admin:admin_views_person_change', args=[person.pk]))
+        self.assertEqual(response.status_code, 200)
+        self.assertFalse(response.context['has_add_permission'])
+        self.assertTrue(response.context['has_change_permission'])
+        self.assertFalse(response.context['show_save_as_new'])
+        
+        # Test Case 3: User with only add permission should NOT see save_as_new (no change permission)
+        user_add_only = User.objects.create_user(username='user_add', password='testpass', is_staff=True)
+        user_add_only.user_permissions.add(add_perm, view_perm)
+        
+        self.client.force_login(user_add_only)
+        response = self.client.get(reverse('admin:admin_views_person_change', args=[person.pk]))
+        self.assertEqual(response.status_code, 200)
+        self.assertTrue(response.context['has_add_permission'])
+        self.assertFalse(response.context['has_change_permission'])
+        self.assertFalse(response.context['show_save_as_new'])
+
 
 @override_settings(ROOT_URLCONF="admin_views.urls")
 class CustomModelAdminTest(AdminViewBasicTestCase):

2026-01-06 15:42:47,170 - INFO - ------------------------------
2026-01-06 15:42:47,170 - INFO - END Runtime Completion Fn
2026-01-06 15:42:47,170 - INFO - ------------------------------
2026-01-06 15:42:47,170 - INFO - Got git diff for instance django__django-16527:
--------
diff --git a/django/contrib/admin/templatetags/admin_modify.py b/django/contrib/admin/templatetags/admin_modify.py
index 9df4b7aadb..5b742af46a 100644
--- a/django/contrib/admin/templatetags/admin_modify.py
+++ b/django/contrib/admin/templatetags/admin_modify.py
@@ -100,6 +100,7 @@ def submit_row(context):
                 and context.get("show_delete", True)
             ),
             "show_save_as_new": not is_popup
+            and has_add_permission
             and has_change_permission
             and change
             and save_as,
diff --git a/tests/admin_views/tests.py b/tests/admin_views/tests.py
index 03ab9a9454..f7fadff4ab 100644
--- a/tests/admin_views/tests.py
+++ b/tests/admin_views/tests.py
@@ -1862,6 +1862,105 @@ class SaveAsTests(TestCase):
         self.assertFalse(response.context["show_save_and_continue"])
         self.assertTrue(response.context["show_save_as_new"])
 
+    def test_save_as_new_permission_issue(self):
+        """
+        Test that demonstrates the issue: show_save_as_new appears even when user
+        doesn't have add permission, only change permission.
+        """
+        # Create a test person object
+        person = Person.objects.create(name='Test Person', gender=1)
+        
+        # Create a regular user with only change permission, not add permission
+        user = User.objects.create_user(username='testuser', password='testpass', is_staff=True)
+        
+        # Get the content type for Person model
+        person_ct = ContentType.objects.get_for_model(Person)
+        
+        # Give the user only change permission, not add permission
+        change_perm = Permission.objects.get(
+            content_type=person_ct,
+            codename='change_person'
+        )
+        user.user_permissions.add(change_perm)
+        
+        # Also give view permission so they can access the admin
+        view_perm = Permission.objects.get(
+            content_type=person_ct,
+            codename='view_person'
+        )
+        user.user_permissions.add(view_perm)
+        
+        # Set up client and login
+        self.client.force_login(user)
+        
+        # Get the change form for the person
+        url = reverse('admin:admin_views_person_change', args=[person.pk])
+        response = self.client.get(url)
+        
+        # Check that we got a successful response
+        self.assertEqual(response.status_code, 200, f"Expected 200, got {response.status_code}")
+        
+        # Check the context variables
+        context = response.context
+        
+        # The issue: show_save_as_new should be False when has_add_permission is False
+        # But currently it's True because it doesn't check has_add_permission
+        has_add = context.get('has_add_permission', False)
+        has_change = context.get('has_change_permission', False)
+        show_save_as_new = context.get('show_save_as_new', False)
+        
+        # This test verifies the fix: show_save_as_new should be False when user doesn't have add permission
+        self.assertFalse(has_add, "User should not have add permission")
+        self.assertTrue(has_change, "User should have change permission")
+        self.assertFalse(
+            show_save_as_new, 
+            "show_save_as_new should be False when user doesn't have add permission"
+        )
+
+    def test_save_as_new_permission_comprehensive(self):
+        """
+        Comprehensive test to verify show_save_as_new behavior with different permission combinations.
+        """
+        # Create a test person object
+        person = Person.objects.create(name='Test Person', gender=1)
+        
+        # Test Case 1: User with both add and change permissions should see save_as_new
+        user_with_both = User.objects.create_user(username='user_both', password='testpass', is_staff=True)
+        person_ct = ContentType.objects.get_for_model(Person)
+        add_perm = Permission.objects.get(content_type=person_ct, codename='add_person')
+        change_perm = Permission.objects.get(content_type=person_ct, codename='change_person')
+        view_perm = Permission.objects.get(content_type=person_ct, codename='view_person')
+        user_with_both.user_permissions.add(add_perm, change_perm, view_perm)
+        
+        self.client.force_login(user_with_both)
+        response = self.client.get(reverse('admin:admin_views_person_change', args=[person.pk]))
+        self.assertEqual(response.status_code, 200)
+        self.assertTrue(response.context['has_add_permission'])
+        self.assertTrue(response.context['has_change_permission'])
+        self.assertTrue(response.context['show_save_as_new'])
+        
+        # Test Case 2: User with only change permission should NOT see save_as_new
+        user_change_only = User.objects.create_user(username='user_change', password='testpass', is_staff=True)
+        user_change_only.user_permissions.add(change_perm, view_perm)
+        
+        self.client.force_login(user_change_only)
+        response = self.client.get(reverse('admin:admin_views_person_change', args=[person.pk]))
+        self.assertEqual(response.status_code, 200)
+        self.assertFalse(response.context['has_add_permission'])
+        self.assertTrue(response.context['has_change_permission'])
+        self.assertFalse(response.context['show_save_as_new'])
+        
+        # Test Case 3: User with only add permission should NOT see save_as_new (no change permission)
+        user_add_only = User.objects.create_user(username='user_add', password='testpass', is_staff=True)
+        user_add_only.user_permissions.add(add_perm, view_perm)
+        
+        self.client.force_login(user_add_only)
+        response = self.client.get(reverse('admin:admin_views_person_change', args=[person.pk]))
+        self.assertEqual(response.status_code, 200)
+        self.assertTrue(response.context['has_add_permission'])
+        self.assertFalse(response.context['has_change_permission'])
+        self.assertFalse(response.context['show_save_as_new'])
+
 
 @override_settings(ROOT_URLCONF="admin_views.urls")
 class CustomModelAdminTest(AdminViewBasicTestCase):
--------
2026-01-06 15:42:50,086 - INFO - Using instance container image: docker.io/swebench/sweb.eval.x86_64.mwaskom_1776_seaborn-3407:latest. Please make sure this image exists. Submit an issue on https://github.com/OpenHands/OpenHands if you run into any issues.
2026-01-06 15:42:50,086 - INFO - Resource mapping for princeton-nlp__SWE-bench_Lite-test not found.
2026-01-06 15:42:50,086 - INFO - Logging LLM completions for instance mwaskom__seaborn-3407 to ./continuum32/princeton-nlp__SWE-bench_Lite-test/CodeActAgent/GLM-4.6-FP8_maxiter_135/llm_completions/mwaskom__seaborn-3407
2026-01-06 15:42:50,087 - INFO - Config file not found: config.toml. Error: [Errno 2] No such file or directory: 'config.toml'
2026-01-06 15:42:50,087 - INFO - Config file not found: [Errno 2] No such file or directory: 'config.toml'. Toml values have not been applied.
